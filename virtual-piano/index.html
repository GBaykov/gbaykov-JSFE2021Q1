<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="assets/piano.ico" rel="shortcut icon">

  <link href="https://fonts.gstatic.com" rel="preconnect">
  <link
    href="https://fonts.googleapis.com/css2?family=Open+Sans+Condensed:wght@300&family=Open+Sans:wght@300;400;800&display=swap"
    rel="stylesheet">
  <link href="style.css" rel="stylesheet">
  

  <title>virtual-piano</title>
</head>

<body>
  <header class="header">
    <h1 class="header-title">Virtual Piano</h1>
  </header>
  <main class="main">
    <div class="btn-container">
      <button class="btn btn-notes btn-active">Notes</button>
      <button class="btn btn-letters">Letters</button>
    </div>
    <div class="piano">
      <div class="piano-key" data-letter="D" data-note="c" data-code="KeyD"></div>
      <div class="piano-key" data-letter="F" data-note="d"></div>
      <div class="piano-key" data-letter="G" data-note="e"></div>
      <div class="piano-key" data-letter="H" data-note="f"></div>
      <div class="piano-key" data-letter="J" data-note="g"></div>
      <div class="piano-key" data-letter="K" data-note="a"></div>
      <div class="piano-key" data-letter="L" data-note="b"></div>
      <div class="keys-sharp">
        <div class="piano-key sharp" data-letter="R" data-note="c♯"></div>
        <div class="piano-key sharp" data-letter="T" data-note="d♯"></div>
        <div class="piano-key sharp none"></div>
        <div class="piano-key sharp" data-letter="U" data-note="f♯"></div>
        <div class="piano-key sharp" data-letter="I" data-note="g♯"></div>
        <div class="piano-key sharp" data-letter="O" data-note="a♯"></div>
      </div>
    </div>
    <button class="fullscreen openfullscreen"></button>
  </main>
  <footer class="footer">
    <div class="footer-container">
      <a class="github" href="#" target="_blank" rel="noopener noreferrer">github</a>
      <a class="rss" href="https://rs.school/js/" target="_blank" rel="noopener noreferrer">
        <span class="rss-year">'21</span>
      </a>
    </div>
  </footer>
  <audio data-code="KeyD" data-key="68" src="assets/audio/a.mp3"></audio>
  <audio data-key="70" src="assets/audio/a♯.mp3"></audio>
  <audio data-key="71" src="assets/audio/b.mp3"></audio>
  <audio data-key="72" src="assets/audio/c.mp3"></audio>
  <audio data-key="74" src="assets/audio/c♯.mp3"></audio>
  <audio data-key="75" src="assets/audio/d.mp3"></audio>
  <audio data-key="76" src="assets/audio/d♯.mp3"></audio>
  <audio data-key="82" src="assets/audio/e.mp3"></audio>
  <audio data-key="84" src="assets/audio/f.mp3"></audio>
  <audio data-key="85" src="assets/audio/f♯.mp3"></audio>
  <audio data-key="73" src="assets/audio/g.mp3"></audio>
  <audio data-key="79" src="assets/audio/g♯.mp3"></audio>
  <script>

const piano = document.querySelector('.piano');
const pianoКeys = document.querySelectorAll('.piano-key');


function playAudio(src) {
    const audio = new Audio();
    audio.src = src;
    audio.currentTime = 0;
    audio.play();
  }
  // фунукция для определения зажатой кнопки мыши. Начало//
  let isMouseDown = false;
document.body.onmousedown = function() { 
  isMouseDown = true;
}
document.body.onmouseup = function() {
  isMouseDown = false;
}
 //функция для определения зажатой кнопки мыши. Конец//

piano.addEventListener('click', (event) => {
    if(event.target.classList.contains('piano-key')) {
        const note = event.target.dataset.note;
        const src = `/assets/audio/${note}.mp3`;
        playAudio(src);
            pianoКeys.forEach((el) => {
              if(el.classList.contains('active')) {
              el.classList.remove('active');
      }
    }); event.target.classList.add('active');
    }   
  });
 

piano.addEventListener('mouseover', (event) => {
    if(event.target.classList.contains('piano-key')) {
        
      const note = event.target.dataset.note;
        const src = `/assets/audio/${note}.mp3`;
        if (isMouseDown) {
          piano.addEventListener('mousedown',playAudio(src) );
}  
piano.removeEventListener('mouseup',playAudio );
    }   
  });
        
 
  
  function playSound(e) {
    const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
    const key = document.querySelector(`div[data-key="${e.keyCode}"]`);
    if (!audio) return;
    audio.currentTime = 0;
    audio.play();
  }
  window.addEventListener('keydown', playSound)

  
  



  </script>
</body>

</html>